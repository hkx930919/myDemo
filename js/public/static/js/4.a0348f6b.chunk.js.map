{"version":3,"sources":["containers/paySuccess/view/container.js","containers/paySuccess/api.js","containers/paySuccess/index.js"],"names":["PaySuccess","connect","state","userinfo","Login_reducer","hks_userInfo","props","_this","Object","classCallCheck","this","possibleConstructorReturn","getPrototypeOf","call","toDetail","history","orderNumber","push","concat","toOrder","isPaySuccess","isLoading","data","_this2","_this$props","location","search","paymentNumber","formatUrl","userID","customer","customerID","axios","url","method","transformRequest","ret","it","encodeURIComponent","headers","Content-Type","source","noErr","then","res","err","setState","code","paymentRequest","originCode","message","error","msg","payText","imgClass","_this$state","loading","_react_16_7_0_react_default","a","createElement","spin","size","className","onClick","aria-hidden","xlinkHref","Component","__webpack_require__","d","__webpack_exports__","actions","reducer_default","container"],"mappings":"oUAkHeA,EA5GdC,kBAAQ,SAAAC,GAAK,MAAK,CACfC,SAAUD,EAAME,cAAcC,8BAG9B,SAAAL,EAAYM,GAAO,IAAAC,EAAA,OAAAC,OAAAC,EAAA,EAAAD,CAAAE,KAAAV,IACfO,EAAAC,OAAAG,EAAA,EAAAH,CAAAE,KAAAF,OAAAI,EAAA,EAAAJ,CAAAR,GAAAa,KAAAH,KAAMJ,KAoDVQ,SAAW,WAAM,IACLC,EAAYR,EAAKD,MAAjBS,QACAC,EAAgBT,EAAKL,MAArBc,YACRD,EAAQE,KAAR,gBAAAC,OAA6BF,KAxDdT,EA0DnBY,QAAU,WACcZ,EAAKD,MAAjBS,QACAE,KAAR,iBA1DAV,EAAKL,MAAQ,CACTc,YAAa,GACbI,aAAc,GACdC,WAAW,GALAd,mFASC,ICjBIe,EDiBJC,EAAAb,KAAAc,EACed,KAAKJ,MAA5BmB,EADQD,EACRC,SAAUtB,EADFqB,EACErB,SACVuB,EAAWD,EAAXC,OACAC,EAAkBC,YAAUF,GAA5BC,cACLA,GCrBiBL,EDsBH,CACTK,gBACAE,OAAQ1B,EAAS2B,SAASC,YCvB/BC,IAAM,CACTC,IAAK,yCACLC,OAAQ,OACRZ,OAGAa,iBAAkB,CACd,SAASb,GACL,IAAIc,EAAM,GACV,IAAK,IAAIC,KAAMf,EACXc,GACIE,mBAAmBD,GACnB,IACAC,mBAAmBhB,EAAKe,IACxB,IAER,OAAOD,IAKfG,QAAS,CAAEC,eAAgB,qCAE3BC,OAAQ,MACRC,OAAO,IACRC,KAAK,SAAAC,GAAG,OAAIA,GAAK,SAAAC,GAAG,OAAIA,KDDhBF,KAAK,SAAAC,GACJrB,EAAKuB,SAAS,CACVzB,WAAW,IAEM,GAAjBuB,EAAItB,KAAKyB,KAETxB,EAAKuB,SACD,CACI9B,YAAa4B,EAAItB,KAAK0B,eAAeC,WACrC7B,cAAc,GAElB,eASJG,EAAKuB,SAAS,CACV1B,cAAc,IAElB8B,EAAA,EAAQC,MAAMP,EAAItB,KAAK8B,QAI/B1C,KAAKoC,SAAS,CACV1B,cAAc,EACdC,WAAU,qCAgBb,IAGDgC,EAAQC,EAHPC,EAC+B7C,KAAKR,MAAjCmB,EADHkC,EACGlC,UAAWD,EADdmC,EACcnC,aACboC,EAAUnC,EAAYoC,EAAAC,EAAAC,cAAAC,EAAA,GAAMC,KAAK,UAAa,KA4BpD,OA1BIzC,GACAkC,EAAW,wBAEXD,EACII,EAAAC,EAAAC,cAAA,WACIF,EAAAC,EAAAC,cAAA,4CACAF,EAAAC,EAAAC,cAAA,yHACAF,EAAAC,EAAAC,cAAA,KAAGG,UAAU,OAAOC,QAASrD,KAAKI,UAAlC,uDAKgB,IAAjBM,IACPkC,EAAW,6BAEXD,EACII,EAAAC,EAAAC,cAAA,WACIF,EAAAC,EAAAC,cAAA,4CAEAF,EAAAC,EAAAC,cAAA,KAAGG,UAAU,OAAOC,QAASrD,KAAKS,SAAlC,oFAQRsC,EAAAC,EAAAC,cAAA,OAAKG,UAAU,wBACXL,EAAAC,EAAAC,cAAA,OAAKG,UAAU,OAAOE,cAAY,QAC9BP,EAAAC,EAAAC,cAAA,OAAKM,UAAWX,KAEnBD,EACAG,UAnGQU,iBETzBC,EAAAC,EAAAC,EAAA,uCAAAC,IAAAH,EAAAC,EAAAC,EAAA,uCAAAE,EAAAb,IAAAS,EAAAC,EAAAC,EAAA,+BAAAG,IAKexE","file":"static/js/4.a0348f6b.chunk.js","sourcesContent":["import React, { Component } from \"react\";\r\nimport { connect } from \"react-redux\";\r\nimport { message, Spin } from \"antd\";\r\nimport \"./index.scss\";\r\nimport { formatUrl } from \"util/util\";\r\nimport { getPayDetail } from \"../api\";\r\n@connect(state => ({\r\n    userinfo: state.Login_reducer.hks_userInfo\r\n}))\r\nclass PaySuccess extends Component {\r\n    constructor(props) {\r\n        super(props);\r\n        this.state = {\r\n            orderNumber: \"\",\r\n            isPaySuccess: \"\",\r\n            isLoading: true,\r\n        };\r\n    }\r\n\r\n    componentDidMount() {\r\n        const { location, userinfo } = this.props;\r\n        const { search } = location;\r\n        const { paymentNumber } = formatUrl(search);\r\n        if(paymentNumber){\r\n            getPayDetail({\r\n                paymentNumber,\r\n                userID: userinfo.customer.customerID\r\n            }).then(res => {\r\n                this.setState({\r\n                    isLoading: false\r\n                });\r\n                if (res.data.code == 0) {\r\n                    //\r\n                    this.setState(\r\n                        {\r\n                            orderNumber: res.data.paymentRequest.originCode,\r\n                            isPaySuccess: true\r\n                        },\r\n                        () => {\r\n                            // setTimeout(() => {\r\n                            //     const { history } = this.props;\r\n                            //     const { orderNumber } = this.state;\r\n                            //     history.push(`/orderDetail/${orderNumber}`);\r\n                            // }, 3000);\r\n                        }\r\n                    );\r\n                } else {\r\n                    this.setState({\r\n                        isPaySuccess: false\r\n                    });\r\n                    message.error(res.data.msg);\r\n                }\r\n            });\r\n        }else{\r\n            this.setState({\r\n                isPaySuccess: false,\r\n                isLoading:false\r\n            });\r\n        }\r\n            \r\n\r\n        \r\n    }\r\n    toDetail = () => {\r\n        const { history } = this.props;\r\n        const { orderNumber } = this.state;\r\n        history.push(`/orderDetail/${orderNumber}`);\r\n    };\r\n    toOrder = () => {\r\n        const { history } = this.props;\r\n        history.push(`/orderManage`);\r\n    };\r\n    render() {\r\n        const { isLoading, isPaySuccess } = this.state;\r\n        const loading = isLoading ? <Spin size=\"large\" /> : null;\r\n        let payText,imgClass;\r\n        if (isPaySuccess) {\r\n            imgClass = '#icon-tijiaochenggong'\r\n\r\n            payText = (\r\n                <div>\r\n                    <h3>支付成功！</h3>\r\n                    <p>订单支付成功，将自动跳转至订单详情。</p>\r\n                    <p className=\"link\" onClick={this.toDetail}>\r\n                        点击这里立即跳转\r\n                    </p>\r\n                </div>\r\n            );\r\n        } else if (isPaySuccess === false) {\r\n            imgClass = '#icon-ic_upload_fail_norma'\r\n\r\n            payText = (\r\n                <div>\r\n                    <h3>支付失败！</h3>\r\n                    {/* <p>订单支付成功，将自动跳转至订单详情。</p> */}\r\n                    <p className=\"link\" onClick={this.toOrder}>\r\n                        点击这里立即跳转到订单列表\r\n                    </p>\r\n                </div>\r\n            );\r\n        }\r\n        \r\n        return (\r\n            <div className=\"paySuccess container\">\r\n                <svg className=\"icon\" aria-hidden=\"true\">\r\n                    <use xlinkHref={imgClass} />\r\n                </svg>\r\n                {payText}\r\n                {loading}\r\n            </div>\r\n        );\r\n    }\r\n}\r\n\r\nexport default PaySuccess;\r\n","import axios from \"axios\";\r\n//支付结果查询接口\r\nexport const getPayDetail = data => {\r\n    return axios({\r\n        url: \"unifyPay/interface/paymentDetail/query\",\r\n        method: \"post\",\r\n        data,\r\n\r\n        //转换数据的方法\r\n        transformRequest: [\r\n            function(data) {\r\n                let ret = \"\";\r\n                for (let it in data) {\r\n                    ret +=\r\n                        encodeURIComponent(it) +\r\n                        \"=\" +\r\n                        encodeURIComponent(data[it]) +\r\n                        \"&\";\r\n                }\r\n                return ret;\r\n            }\r\n        ],\r\n\r\n        //设置请求头\r\n        headers: { \"Content-Type\": \"application/x-www-form-urlencoded\" },\r\n\r\n        source: \"pay\",\r\n        noErr: true\r\n    }).then(res => res, err => err);\r\n};\r\n","import * as PaySuccess_actions from './actions.js'\r\nimport PaySuccess_reducer from './reducer.js'\r\nimport PaySuccess from './view/container.js'\r\n\r\nexport {PaySuccess_actions, PaySuccess_reducer, PaySuccess}\r\nexport default PaySuccess\r\n"],"sourceRoot":""}